# 03_函数和方法

## 1. **函数**

在Go中，函数是非常重要的组成部分。函数定义语法如下：

```go
func 函数名(参数1 类型1, 参数2 类型2, ...) (返回值 类型1, 返回值2 类型2) {
    // 函数体
}
```

### 1.1 **函数定义**

```go
func add(a int, b int) int {
    return a + b
}
```

* **返回值类型**：Go函数可以有多个返回值，多个返回值时以逗号分隔。
* **参数类型**：每个参数都要显式指定类型，也可以省略类型，Go会根据值自动推断。

### 1.2 **返回多个值**

```go
func swap(a, b int) (int, int) {
    return b, a
}

x, y := swap(1, 2)
fmt.Println(x, y) // 输出: 2 1
```

### 1.3 **命名返回值**

Go支持命名返回值，这样可以让函数体内直接使用返回值变量，无需在 `return` 语句中显式写出。

```go
func getValues() (x int, y int) {
    x = 10
    y = 20
    return
}
```

### 1.4 **可变参数**

Go支持函数的可变参数，可以接收任意数量的参数，类型固定。参数类型在定义时必须是一个切片类型。

```go
func sum(nums ...int) int {
    total := 0
    for _, num := range nums {
        total += num
    }
    return total
}

fmt.Println(sum(1, 2, 3, 4)) // 输出: 10
```

### 1.5 **匿名函数**

匿名函数是没有名称的函数。它常常用于短小的功能，或者作为参数传递。

```go
func() {
    fmt.Println("Hello, World!")
}()
```

匿名函数也可以赋值给变量：

```go
f := func(x, y int) int {
    return x + y
}
fmt.Println(f(3, 4)) // 输出: 7
```

### 1.6 **函数作为参数**

Go支持将函数作为参数传递给其他函数。这使得Go具有非常强大的函数式编程能力。

```go
func apply(x, y int, fn func(int, int) int) int {
    return fn(x, y)
}

result := apply(3, 4, add) // 使用上面定义的 add 函数
fmt.Println(result) // 输出: 7
```

## 2. **方法**

方法是绑定在特定类型上的函数，Go语言中没有类和继承的概念，但通过方法可以模拟类的行为。

### 2.1 **方法定义**

```go
type Rectangle struct {
    Width, Height int
}

// 定义方法
func (r Rectangle) Area() int {
    return r.Width * r.Height
}

func (r Rectangle) Perimeter() int {
    return 2 * (r.Width + r.Height)
}
```

* `(r Rectangle)`：表示方法接收者的类型是 `Rectangle`，它绑定到 `Rectangle` 类型的方法上。
* 可以选择值接收者（值拷贝）或者指针接收者（对原对象进行操作）。

### 2.2 **方法接收者**

* **值接收者**：方法内部对接收者的任何修改不会影响原对象。

```go
func (r Rectangle) SetWidth(width int) {
    r.Width = width
}
```

* **指针接收者**：方法内部对接收者的修改会影响原对象。

```go
func (r *Rectangle) SetWidth(width int) {
    r.Width = width
}
```

### 2.3 **方法和函数的区别**

* 方法是绑定到特定类型上的函数，而普通的函数是独立存在的。
* 方法通过接收者来修改对象的状态，而函数一般不涉及修改原始数据。

## 3. **方法和接口**

Go语言的接口是通过方法集实现的，一个类型只要实现了某个接口的方法集，就自动满足了该接口，无需显式声明实现。

```go
type Shape interface {
    Area() int
}

type Rectangle struct {
    Width, Height int
}

func (r Rectangle) Area() int {
    return r.Width * r.Height
}

func printArea(s Shape) {
    fmt.Println(s.Area())
}

r := Rectangle{Width: 10, Height: 5}
printArea(r) // 输出: 50
```

* `Shape` 接口要求实现 `Area` 方法，`Rectangle` 类型自动满足 `Shape` 接口。
* 接口的实现是隐式的，不需要声明。

## 4. **总结**

* Go语言中的函数和方法非常灵活，支持多个返回值、命名返回值、可变参数等特性。
* 方法是绑定在特定类型上的函数，可以通过值接收者或指针接收者来定义方法。
* 接口通过方法集来实现，Go不需要显式声明某个类型实现了某个接口，只要实现了接口中的所有方法。

